<!DOCTYPE html>
<meta charset="utf-8">
<style>
path {
  stroke: white;
  stroke-width: 0.25px;
  fill: grey;
}
</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v0.min.js"></script>
<script>
var width = 960,
    height = 500;

var projection = d3.geo.mercator()
    .scale(200);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var path = d3.geo.path()
    .projection(projection);

var g = svg.append("g");

var select;

// load and display the World
d3.json("map/world-110m2.json", function(error, topology) {

  // load and display the cities
  d3.csv("data/CIGI_Indicators.csv", function(error, data) {
    console.log(data);
      g.selectAll("circle")
         .data(data)
         .enter()
         .append("a")
  				  .attr("xlink:href", function(d) {
  					  return "https://www.google.com/search?q="+d.Country;}
  				  )
         .append("circle")
         .attr("cx", function(d) {
                 return projection([d.geo_longitude, d.geo_latitude])[0];
         })
         .attr("cy", function(d) {
                 return projection([d.geo_longitude, d.geo_latitude])[1];
         })
         .attr("r", function(d){ return d.Internet_Pen*0.15;})
         .style("fill", "red")
         .append("svg:title")
          .text(function(d) { return d.Country + ", Internet Penetration: " + d.Internet_Pen; });

      select  = d3.select("#optButton").append("select").on("change", change),
      options = select.selectAll('option').data(data); // Data join

      // Enter selection
      options.enter().append("option").text(function(d,i) { return d[0].Country; });
  });


  g.selectAll("path")
        .data(topojson.object(topology, topology.objects.countries)
            .geometries)
      .enter()
        .append("path")
        .attr("d", path);
});

// zoom and pan
var zoom = d3.behavior.zoom()
    .scaleExtent([1, 8])
    .on("zoom", move);

function move() {
  var t = d3.event.translate,
      s = d3.event.scale;
  t[0] = Math.min(width / 2 * (s - 1), Math.max(width / 2 * (1 - s), t[0]));
  t[1] = Math.min(height / 2 * (s - 1) + 230 * s, Math.max(height / 2 * (1 - s) - 230 * s, t[1]));
  zoom.translate(t);
  g.style("stroke-width", 1 / s).attr("transform", "translate(" + t + ")scale(" + s + ")");
}

function change() {
    var selectedIndex = select.property('selectedIndex'),
        data          = options[0][selectedIndex].__data__;
}

svg.call(zoom)

</script>

<select id="#optButton"></select>
<span id="name"></span>
<span id=""></span>

<!-- FIELDS
Access_DigContent: "4.2"
BMStatus: "7.02"
CSOIndex: "6"
CSOtraditions: "8"
CivicusEnabEnviro: "0.55"
Country: "Albania"
DIScore: "5.67"
DI_RegimeType: "Hybrid Regime"
E-participation: "0.1053"
EPgovern: "7"
Econ_CyberPower: ""
EffectiveSupport: "7"
FOC: "0"
Fixed_BB_Subscribers: "4.957592444"
FreedomHouse: "PF"
G20: "0"
GDP_Cap: "3999.92531"
GovPartner: "7"
HDI: "0.749"
ICT_Goods_Imp: "3.579902835"
ICT_Goods_X: "0.523498088"
ICT_Service_X: "10.91825178"
InterestGroups: "6"
InternetUsers: ""
Internet_Pen: "54.7"
Intl_Int_Bandwidth: "19"
Literacy_Rate: "96.8453"
MobilePen: "108.4473347"
NtlReplies: "0"
PoliWeb: ""
Pop_15_29: "28.3"
Population: "3162083"
Reso_Sponsor: "0"
SN_Use: "5.5"
SecureServers: "13.7"
UNGGE: "0"
USAID_NGO: "3.9"
WCITVote: "0"
WEF_Inno_Cap: "3"
WEF_Tech_Readiness_Index: "3.75"
WEF_Uni_Indus: "2.6"
WGIPoliStab: "-0.16"
WGIVoiceAccountability: "0.01" 
-->

</body>
</html>